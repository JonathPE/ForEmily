<!DOCTYPE html>
<html>
<head>
    <title>Snowy Dinosaur Game v8</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: #e0f0ff;
            font-family: Arial, sans-serif;
            touch-action: manipulation;
        }
        
        #gameContainer {
            position: relative;
            width: 90vw;
            height: 90vh;
            max-width: 800px;
            max-height: 400px;
            overflow: hidden;
            background: linear-gradient(to bottom, #b0d0ff, #d0e8ff);
            cursor: pointer;
        }

        #ground {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 8%;
            min-height: 30px;
            background: #ffffff;
            z-index: 3;
        }

        #player {
            position: absolute;
            bottom: 8%;
            left: 50px;
            width: 3.5%;
            height: 8%;
            min-width: 25px;
            min-height: 25px;
            background: #2c3e50;
            border-radius: 4px;
            z-index: 4;
        }

        .obstacle {
            position: absolute;
            bottom: 6%;
            width: 3%;
            height: 9%;
            min-width: 20px;
            min-height: 30px;
            background: #636e72;
            clip-path: polygon(100% 80%, 0% 100%, 0% 20%, 50% 0%, 100% 20%);
            border-radius: 3px;
            z-index: 2;
            box-shadow: inset 0 5px 5px rgba(0,0,0,0.2);
        }

        .mountain {
            position: absolute;
            bottom: 8%;
            width: var(--mountain-width);
            height: var(--mountain-height);
            clip-path: polygon(50% 0%, 100% 100%, 0% 100%);
            z-index: 1;
        }

        .snowflake {
            position: absolute;
            color: #fff;
            user-select: none;
            z-index: 0;
        }

        #score {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 20px;
            color: #2c3e50;
            z-index: 4;
            font-family: 'Press Start 2P', cursive;
            font-size: 2vh;
        }

        #deathScreen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 5;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            text-align: center;
            font-family: 'Press Start 2P', cursive;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        #deathScreen h2 {
            font-size: 4vh;
            margin: 0 0 2vh 0;
        }

        #deathScreen p {
            font-size: 2.5vh;
            margin: 1vh 0;
        }

        @media (max-width: 600px) {
            #player {
                width: 5vw;
                height: 8vw;
            }
            .obstacle {
                width: 4vw;
                height: 6vw;
            }
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <div id="score">0</div>
        <div id="player"></div>
        <div id="ground"></div>
        <div id="deathScreen">
            <h2>GAME OVER!</h2>
            <p>SCORE: <span id="finalScore">0</span></p>
            <p>HIGH SCORE: <span id="highScore">0</span></p>
            <p>(TAP OR SPACE TO RESTART)</p>
        </div>
    </div>

    <script>
        const player = document.getElementById('player');
        const gameContainer = document.getElementById('gameContainer');
        const scoreElement = document.getElementById('score');
        const deathScreen = document.getElementById('deathScreen');
        const finalScoreElement = document.getElementById('finalScore');
        const highScoreElement = document.getElementById('highScore');
        
        let isJumping = false;
        let isDead = false;
        let score = 0;
        let gravity = 0.9;
        let velocity = 0;
        let playerBottom = 8;
        let highScore = localStorage.getItem('highScore') || 0;
        let animationIDs = [];
        let intervalIDs = [];
        let gameSpeed = 8;
        const maxGameSpeed = 20;

        highScoreElement.textContent = highScore;

        function createMountain() {
            const mountain = document.createElement('div');
            mountain.className = 'mountain';
            
            const width = 200 + Math.random() * 300;
            const height = 100 + Math.random() * 150;
            const snowPercentage = 10 + Math.random() * 15;
            
            mountain.style.setProperty('--mountain-width', `${width}px`);
            mountain.style.setProperty('--mountain-height', `${height}px`);
            mountain.style.right = `-${width}px`;
            mountain.style.background = `linear-gradient(
                to bottom,
                white ${snowPercentage}%,
                #95a5a6 ${snowPercentage + 0.1}%
            )`;
            
            gameContainer.appendChild(mountain);
            
            let position = -width;
            function animate() {
                position += gameSpeed/8;
                mountain.style.right = `${position}px`;
                
                if (position < gameContainer.offsetWidth + width) {
                    const id = requestAnimationFrame(animate);
                    animationIDs.push(id);
                } else {
                    mountain.remove();
                }
            }
            animate();
        }

        function createSnowflake() {
            const snowflake = document.createElement('div');
            snowflake.className = 'snowflake';
            snowflake.innerHTML = 'â„';
            snowflake.style.left = Math.random() * gameContainer.offsetWidth + 'px';
            snowflake.style.fontSize = (10 + Math.random() * 10) + 'px';
            snowflake.style.opacity = 0.7;
            gameContainer.appendChild(snowflake);

            let top = 0;
            function fall() {
                top += 2;
                snowflake.style.top = top + 'px';
                
                if (top < gameContainer.offsetHeight) {
                    const id = requestAnimationFrame(fall);
                    animationIDs.push(id);
                } else {
                    snowflake.remove();
                }
            }
            fall();
        }

        function jump() {
            if (!isJumping && !isDead) {
                isJumping = true;
                velocity = 9;
            }
        }

        function createObstacle() {
            const obstacle = document.createElement('div');
            obstacle.className = 'obstacle';
            obstacle.style.right = '-25px';
            obstacle.style.height = 30 + Math.random() * 20 + 'px';
            gameContainer.appendChild(obstacle);

            let position = -25;
            function animate() {
                position += gameSpeed;
                obstacle.style.right = position + 'px';

                const playerRect = player.getBoundingClientRect();
                const obstacleRect = obstacle.getBoundingClientRect();
                
                if (
                    playerRect.right > obstacleRect.left &&
                    playerRect.left < obstacleRect.right &&
                    playerRect.bottom > obstacleRect.top
                ) {
                    gameOver();
                }

                if (position < gameContainer.offsetWidth + 25) {
                    const id = requestAnimationFrame(animate);
                    animationIDs.push(id);
                } else {
                    obstacle.remove();
                }
            }
            animate();
        }

        function gameOver() {
            if (isDead) return;
            isDead = true;
            deathScreen.style.display = 'flex';
            finalScoreElement.textContent = score;
            
            if (score > highScore) {
                highScore = score;
                localStorage.setItem('highScore', highScore);
                highScoreElement.textContent = highScore;
            }
            
            animationIDs.forEach(id => cancelAnimationFrame(id));
            intervalIDs.forEach(id => clearInterval(id));
        }

        function resetGame() {
            isDead = false;
            score = 0;
            gameSpeed = 8;
            scoreElement.textContent = '0';
            playerBottom = 8;
            velocity = 0;
            isJumping = false;
            player.style.bottom = '8%';
            
            document.querySelectorAll('.obstacle, .mountain, .snowflake').forEach(el => el.remove());
            
            animationIDs = [];
            intervalIDs = [];
            
            intervalIDs.push(setInterval(createMountain, 3500));
            intervalIDs.push(setInterval(createSnowflake, 100));
            intervalIDs.push(setInterval(() => {
                score++;
                scoreElement.textContent = score;
                if (score % 100 === 0 && gameSpeed < maxGameSpeed) {
                    gameSpeed += 1;
                }
            }, 100));
            setTimeout(generateObstacle, 1500);
            
            deathScreen.style.display = 'none';
            updatePlayer();
        }

        function generateObstacle() {
            createObstacle();
            const nextInterval = 800 + Math.random() * 800;
            const id = setTimeout(generateObstacle, nextInterval);
            intervalIDs.push(id);
        }

        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                e.preventDefault();
                if (isDead) {
                    resetGame();
                } else {
                    jump();
                }
            }
        });

        gameContainer.addEventListener('click', jump);
        gameContainer.addEventListener('touchstart', (e) => {
            e.preventDefault();
            if (isDead) {
                resetGame();
            } else {
                jump();
            }
        });

        intervalIDs.push(setInterval(createMountain, 3500));
        intervalIDs.push(setInterval(createSnowflake, 100));
        intervalIDs.push(setInterval(() => {
            score++;
            scoreElement.textContent = score;
            if (score % 100 === 0 && gameSpeed < maxGameSpeed) {
                gameSpeed += 1;
            }
        }, 100));
        setTimeout(generateObstacle, 1500);

        function updatePlayer() {
            if (!isDead) {
                velocity -= gravity;
                playerBottom += velocity;
                
                const containerHeight = gameContainer.offsetHeight;
                const groundHeight = document.getElementById('ground').offsetHeight;
                const minBottom = (groundHeight / containerHeight * 100) + 0.5;
                
                if (playerBottom <= minBottom) {
                    playerBottom = minBottom;
                    isJumping = false;
                    velocity = 0;
                }
                
                player.style.bottom = `${playerBottom}%`;
            }
            const id = requestAnimationFrame(updatePlayer);
            animationIDs.push(id);
        }

        updatePlayer();
    </script>
</body>
</html>  
